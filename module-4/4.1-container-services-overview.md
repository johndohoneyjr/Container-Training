# Module 4.1: Azure Container Services Overview

## Overview
This lab provides a comprehensive comparison of Azure's container hosting options to help you make informed decisions about which service to use for your containerized .NET applications.

---

## Prerequisites
- Active Azure subscription
- Azure CLI installed and configured
- Access to Azure Portal
- Basic understanding of containers and Docker

---

## Learning Objectives
By the end of this lab, you will be able to:
- Compare and contrast Azure container hosting services
- Use a decision matrix to select the appropriate service
- Understand pricing models and SLA commitments
- Evaluate use cases for each service
- Navigate the Azure Portal to explore container services

---

## 1. Azure Container Services Comparison

### 1.1 Services Comparison Table

| Service | Use Case | Orchestration | Complexity | Scaling | Cost Model |
|---------|----------|---------------|------------|---------|------------|
| **Azure Container Instances (ACI)** | Simple, short-lived containers | None | Low | Manual/Scheduled | Per-second billing |
| **Azure Container Apps (ACA)** | Microservices, event-driven apps | Managed Kubernetes (KEDA) | Low-Medium | Auto (HTTP, Queue, CPU) | Consumption + Reserved |
| **Azure App Service (Containers)** | Web apps, APIs | App Service platform | Low | Auto (rules-based) | App Service Plan |
| **Azure Kubernetes Service (AKS)** | Complex orchestration, full control | Kubernetes | High | Auto (HPA, CA, KEDA) | Node-based pricing |
| **Azure Container Apps Jobs** | Batch processing, scheduled tasks | Managed | Low | Job-based | Per execution |

---

## 2. Detailed Service Analysis

### 2.1 Azure Container Instances (ACI)

**Best For:**
- Quick testing and development
- Batch jobs and scheduled tasks
- Burst computing scenarios
- Simple containerized workloads
- CI/CD build agents

**Key Features:**
- Fastest container deployment in Azure (~5 seconds)
- Per-second billing (cost-effective for short tasks)
- No infrastructure management
- Direct integration with Azure Virtual Network
- Support for both Linux and Windows containers

**Limitations:**
- No built-in load balancing
- Limited orchestration capabilities
- Manual scaling only
- Not suitable for production microservices

**Pricing Model:**
- Pay per second for vCPU and memory
- Example: 1 vCPU + 1 GB RAM = ~$0.0000012/second
- Ideal for workloads running < 1 hour

---

### 2.2 Azure Container Apps (ACA)

**Best For:**
- Modern microservices architectures
- Event-driven applications
- Serverless containers
- API backends
- Background workers processing queues

**Key Features:**
- Built-in KEDA autoscaling (HTTP, queue, custom metrics)
- Dapr integration for microservices patterns
- Automatic HTTPS certificate management
- Traffic splitting for blue-green deployments
- Scale to zero capability
- Revision management

**Limitations:**
- Less control than AKS
- Limited Kubernetes customization
- Newer service (less mature ecosystem)

**Pricing Model:**
- Consumption-based: Pay for vCPU and memory used
- Reserved capacity: Pre-purchase capacity at discount
- Free tier: 180,000 vCPU-seconds + 360,000 GiB-seconds/month

---

### 2.3 Azure App Service with Containers

**Best For:**
- Traditional web applications
- RESTful APIs
- Organizations already using App Service
- Teams familiar with PaaS environments

**Key Features:**
- Easy integration with existing App Service features
- Built-in CI/CD with GitHub and Azure DevOps
- Deployment slots for staging
- Automatic patching and scaling
- Custom domains and SSL certificates
- VNet integration

**Limitations:**
- Less flexible than AKS
- Tied to App Service ecosystem
- No multi-container pod support

**Pricing Model:**
- Based on App Service Plan tier
- Basic: $13.14/month
- Standard: $73.00/month
- Premium V3: Starts at $100/month

---

### 2.4 Azure Kubernetes Service (AKS)

**Best For:**
- Enterprise-grade applications
- Complex microservices architectures
- Multi-cloud strategies
- Teams with Kubernetes expertise
- Advanced orchestration requirements

**Key Features:**
- Full Kubernetes capabilities
- Complete control over cluster configuration
- Advanced networking options
- Support for Helm charts and operators
- Cluster autoscaling and node pools
- Integration with Azure Monitor and Azure Policy

**Limitations:**
- Highest complexity and learning curve
- Requires Kubernetes knowledge
- More operational overhead
- Higher costs for small workloads

**Pricing Model:**
- Free cluster management
- Pay only for VM nodes (agent pool)
- Standard_D2s_v3: ~$96.36/month per node
- Minimum 3 nodes recommended for production

---

## 3. Decision Matrix

### 3.1 When to Use Each Service

```
┌─────────────────────────────────────────────────────────────┐
│                    DECISION FLOW                            │
└─────────────────────────────────────────────────────────────┘

START: Need to run containers in Azure
│
├─ Simple, short-lived task?
│  └─ YES → Use ACI
│      • Batch jobs
│      • Build agents
│      • Quick tests
│
├─ Modern microservices or event-driven?
│  └─ YES → Use Container Apps
│      • Auto-scaling needs
│      • Scale to zero desired
│      • Event-driven architecture
│
├─ Traditional web app or API?
│  └─ YES → Use App Service
│      • Existing App Service experience
│      • Need deployment slots
│      • Simple web application
│
└─ Complex orchestration or full K8s control?
   └─ YES → Use AKS
       • Enterprise requirements
       • Multi-service coordination
       • Need Kubernetes features
```

### 3.2 Detailed Decision Criteria

| Criteria | ACI | Container Apps | App Service | AKS |
|----------|-----|----------------|-------------|-----|
| **Setup Time** | < 1 minute | 5-10 minutes | 5-10 minutes | 15-30 minutes |
| **Learning Curve** | Low | Low-Medium | Low | High |
| **Auto-scaling** | ❌ | ✅ (HTTP, Queue, CPU) | ✅ (Rule-based) | ✅ (HPA, CA, KEDA) |
| **Scale to Zero** | ❌ | ✅ | ❌ | ❌ (manual) |
| **Multi-container** | ✅ (groups) | ✅ (Dapr) | ❌ | ✅ (pods) |
| **Load Balancing** | ❌ | ✅ | ✅ | ✅ |
| **Custom Networking** | Basic | Good | Good | Advanced |
| **Development Velocity** | Fast | Fast | Fast | Moderate |
| **Production Grade** | ❌ | ✅ | ✅ | ✅ |
| **Cost (Small Workload)** | $ | $$ | $$$ | $$$$ |

---

## 4. Pricing Models Comparison

### 4.1 Cost Scenarios

**Scenario 1: Development/Testing (1 container, 8 hours/day)**

| Service | Monthly Cost (Estimate) |
|---------|-------------------------|
| ACI (1 vCPU, 1 GB) | ~$25 |
| Container Apps (0.5 vCPU, 1 GB) | ~$30 |
| App Service (Basic B1) | ~$13 |
| AKS (1 node, Standard_B2s) | ~$30 |

**Scenario 2: Production API (3 instances, 24/7)**

| Service | Monthly Cost (Estimate) |
|---------|-------------------------|
| ACI (3x 1 vCPU, 1.5 GB) | ~$235 |
| Container Apps (reserved) | ~$70-150 |
| App Service (Standard S1) | ~$73 |
| AKS (3 nodes, Standard_D2s_v3) | ~$289 |

**Scenario 3: Event-Driven with Scaling to Zero**

| Service | Monthly Cost (Estimate) |
|---------|-------------------------|
| Container Apps | ~$20-50 (consumption) |
| All others | Not cost-effective |

> **Note:** Prices are estimates and vary by region. Always use Azure Pricing Calculator for accurate projections.

---

## 5. SLA and Availability Overview

### 5.1 Service Level Agreements

| Service | SLA | Availability | Failover |
|---------|-----|--------------|----------|
| **ACI** | 99.9% | Single region | Manual |
| **Container Apps** | 99.95% | Zone redundant available | Automatic |
| **App Service** | 99.95% | Zone redundant available | Automatic |
| **AKS** | 99.95% (Standard), 99.99% (Premium) | Multi-zone support | Automatic with multi-node |

### 5.2 High Availability Considerations

**ACI:**
- No built-in HA
- Use for non-critical workloads
- Implement retry logic in callers

**Container Apps:**
- Automatic load balancing across replicas
- Zone redundancy in supported regions
- Health probes and automatic restart

**App Service:**
- Zone redundancy available (Premium tiers)
- Deployment slots for zero-downtime deployments
- Auto-healing capabilities

**AKS:**
- Multi-zone node pools
- Pod disruption budgets
- Cluster autoscaler for resilience
- 99.99% SLA with Uptime SLA enabled

---

## 6. Lab Exercise: Explore Azure Portal

### Lab 6.1: Review Container Services in Portal

**Step 1: Access Azure Portal**
```bash
# Login to Azure
az login

# Set your subscription
az account set --subscription "<your-subscription-id>"

# Verify current subscription
az account show --output table
```

**Step 2: Explore Azure Container Instances**

1. Navigate to Azure Portal: https://portal.azure.com
2. Search for "Container Instances" in the top search bar
3. Click "+ Create" to see the creation form
4. Note the configuration options:
   - Container name and region
   - Image source (ACR, Docker Hub, etc.)
   - Networking options
   - Resource limits (CPU, memory)
   - Environment variables
   - Restart policy options

**Step 3: Explore Azure Container Apps**

1. Search for "Container Apps" in the portal
2. Click "+ Create"
3. Observe the additional features:
   - Container Apps Environment (shared infrastructure)
   - Ingress configuration
   - Scaling rules (HTTP, Queue, CPU, Custom)
   - Revision management
   - Dapr enablement

**Step 4: Explore App Service**

1. Search for "App Services"
2. Click "+ Create" → "Web App"
3. Note these options:
   - Publish: Code vs. Docker Container
   - Operating System: Linux (for containers)
   - App Service Plan tiers
   - Deployment options
   - Monitoring integration

**Step 5: Explore Azure Kubernetes Service**

1. Search for "Kubernetes services"
2. Click "+ Create"
3. Review advanced configuration:
   - Node pools and VM sizes
   - Authentication and authorization
   - Networking configuration (CNI, Kubenet)
   - Integrations (ACR, Azure Monitor)
   - Add-ons (HTTP application routing, monitoring)

---

### Lab 6.2: Use Azure Pricing Calculator

**Step 1: Access Pricing Calculator**

Visit: https://azure.microsoft.com/en-us/pricing/calculator/

**Step 2: Calculate ACI Costs**

1. Search for "Container Instances"
2. Configure:
   - Region: East US
   - OS: Linux
   - vCPUs: 1
   - Memory: 1 GB
   - Duration: 720 hours/month
3. Note the monthly estimate

**Step 3: Calculate Container Apps Costs**

1. Add "Container Apps"
2. Configure:
   - vCPU: 0.5
   - Memory: 1 GB
   - Requests per second: 100
   - Average request duration: 100ms
3. Compare consumption vs. reserved pricing

**Step 4: Calculate App Service Costs**

1. Add "App Service"
2. Configure:
   - OS: Linux
   - Tier: Standard (S1)
   - Instances: 3
3. Note monthly cost

**Step 5: Calculate AKS Costs**

1. Add "Azure Kubernetes Service"
2. Configure:
   - Nodes: 3
   - VM Size: Standard_D2s_v3
   - Managed Disks: 3x 128 GB Premium SSD
   - Public IP: Standard
   - Load Balancer: Standard
3. Note that AKS control plane is free
4. Calculate total monthly cost

---

## 7. Use Case Scenarios

### Scenario 1: Startup MVP
**Requirements:** Quick deployment, minimal complexity, low initial costs

**Recommendation:** **Container Apps**
- Fast time to market
- Auto-scaling as you grow
- Consumption-based pricing
- Easy to migrate to AKS later if needed

---

### Scenario 2: Batch Processing Jobs
**Requirements:** Run nightly data processing, complete in 30 minutes, cost-sensitive

**Recommendation:** **ACI**
- Pay only for execution time
- Simple deployment
- No idle costs
- Perfect for scheduled tasks

---

### Scenario 3: Enterprise Microservices
**Requirements:** 50+ microservices, complex networking, compliance requirements

**Recommendation:** **AKS**
- Full control and customization
- Advanced networking (service mesh)
- Enterprise security features
- Scalability for growth

---

### Scenario 4: Legacy App Modernization
**Requirements:** Existing .NET web app, minimal containerization effort

**Recommendation:** **App Service with Containers**
- Familiar App Service features
- Easy migration path
- Built-in deployment slots
- Integrated monitoring

---

### Scenario 5: Event-Driven Architecture
**Requirements:** Process messages from queues, scale to zero when idle

**Recommendation:** **Container Apps**
- KEDA-based queue scaling
- Scale to zero capability
- Dapr for pub/sub patterns
- Cost-effective for variable workloads

---

## 8. Best Practices Summary

### 8.1 General Best Practices

✅ **DO:**
- Start with the simplest service that meets your needs
- Use managed services when possible (less operational overhead)
- Consider future scalability requirements
- Evaluate total cost of ownership (TCO), not just compute costs
- Test your application on the target service before committing

❌ **DON'T:**
- Use AKS for simple workloads
- Over-provision resources
- Ignore monitoring and logging requirements
- Choose based on hype or trends
- Lock yourself into a single approach

### 8.2 Migration Path

```
Development → Production Growth Path:

ACI (Development/Testing)
  ↓
Container Apps (Production Microservices)
  ↓
AKS (Enterprise Scale)
```

---

## 9. Troubleshooting Guide

### Issue 1: "Which service is right for my application?"

**Solution:**
1. Answer these questions:
   - How many containers? (1 = ACI, 2-10 = Container Apps, 10+ = AKS)
   - Need auto-scaling? (No = ACI, Yes = others)
   - Have Kubernetes expertise? (No = Container Apps/App Service, Yes = AKS)
   - Need scale to zero? (Yes = Container Apps only)
2. Start conservative, migrate as needed

---

### Issue 2: "Unexpected high costs"

**Solution:**
1. Review actual resource utilization
2. Check for over-provisioning
3. Consider reserved capacity for consistent workloads
4. Enable auto-scaling to match demand
5. Use Azure Cost Management for analysis

---

### Issue 3: "Performance issues"

**Solution:**
1. Check resource limits (CPU, memory)
2. Review scaling configuration
3. Verify network configuration
4. Check application health probes
5. Enable Application Insights for diagnostics

---

## 10. Additional Resources

### Official Documentation
- [Azure Container Instances](https://docs.microsoft.com/azure/container-instances/)
- [Azure Container Apps](https://docs.microsoft.com/azure/container-apps/)
- [App Service Linux Containers](https://docs.microsoft.com/azure/app-service/containers/)
- [Azure Kubernetes Service](https://docs.microsoft.com/azure/aks/)

### Pricing Information
- [Azure Pricing Calculator](https://azure.microsoft.com/pricing/calculator/)
- [Container Instances Pricing](https://azure.microsoft.com/pricing/details/container-instances/)
- [Container Apps Pricing](https://azure.microsoft.com/pricing/details/container-apps/)
- [AKS Pricing](https://azure.microsoft.com/pricing/details/kubernetes-service/)

### Decision Tools
- [Azure Architecture Center](https://docs.microsoft.com/azure/architecture/)
- [Container Service Comparison](https://docs.microsoft.com/azure/container-instances/container-instances-overview#comparison-with-azure-container-apps)

---

## Summary

You have now explored Azure's container hosting options and understand:

✅ The four main Azure container services and their use cases  
✅ How to choose the right service using a decision matrix  
✅ Pricing models and cost optimization strategies  
✅ SLA commitments and availability features  
✅ How to navigate the Azure Portal to explore services  
✅ Real-world scenarios and recommendations  

**Next Steps:**
- Proceed to **Module 4.2** to learn Azure Container Instances hands-on
- Bookmark the Azure Pricing Calculator for future reference
- Review your current applications and identify containerization candidates

---

**© 2026 Progress Software Corporation. All rights reserved.**
